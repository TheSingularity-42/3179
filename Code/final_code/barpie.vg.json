{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "background" : null,
    "params": [
        {
            "name": "selectFilter",
            "select" :{
                "type": "point",
                "fields": ["shark"],
                "on" : "click"
            }
        }
    ],
    "config": {
        "title": {
            "fontSize" : 28  
        },
        "axis": {
            "titleFontSize" : 24,
            "labelFontSize" :16
        },
        "view": {
            "stroke" : "transparent",
            "discreteWidth": {"step": 10}
            
        },
        "legend": {
            "titleFontSize": 26
        }
        
    },
    "vconcat" :[
        
        {
    "data": {
    "url": "https://raw.githubusercontent.com/TheSingularity-42/3179/main/VegaLite/Assignment2Data/SharkAttacks.csv"
    },
    "width" :350,
    "height" : 400,
    "transform": [
    {"calculate": "year(datum.year)", "as": "Year"},
    {
        "lookup": "shark",
        "from": {
        "data": {
        "values": [
        {"shark": "bull shark"},
        {"shark": "bronze whaler shark"},
        {"shark": "wobbegong"},
        {"shark": "hammerhead shark "},
        {"shark": "tiger shark"},
        {"shark": "white shark"}
    ]
    },
        "key": "shark",
        "fields": ["shark"]
    },
        "default": "other"
    },

    {"aggregate": [{"op": "count", "as": "sharkcount"}], "groupby": ["shark"]}
    ],
    "mark": "arc",
    "encoding": {
    "theta": {"field": "sharkcount", "type": "quantitative"
    },
    "color": {
        "field": "shark",
        "type": "nominal",
        "scale": {
        "domain": ["bull shark", "bronze whaler shark", "wobbegong", "hammerhead shark ", "tiger shark", "white shark", "other"],
        "range": ["#4A4A4A", "#914928", "#c19a6b", "#4e7496", "#b24022", "#6e7784", "#c7c7c7"]
        },
        "title": "Shark Species",
        "legend": {
            "title": "Shark Species",
            "titleFontSize":24,
        "labelFontSize":16,
        "labelExpr": "datum.value === 'bull shark' ? 'Bull Shark' : datum.value === 'bronze whaler shark' ? 'Bronze Whaler Shark' : datum.value === 'blind shark' ? 'Blind Shark' : datum.value === 'hammerhead shark ' ? 'Hammerhead Shark' : datum.value === 'tiger shark' ? 'Tiger Shark' : datum.value === 'white shark' ? 'White Shark' : datum.value === 'wobbegong' ? 'Wobbegong' : 'Other'"
        }
    },
    "opacity" :{
        "condition" : {
            "param": "selectFilter",
            "value" : 1
        },
        "value" : 0.3
        },
    "tooltip":[
        {"field": "shark", "type": "nominal", "title": "Shark Species"},
        {"field" :"sharkcount" , "title" : "Number Of Attacks"}
    ]
    }

        },
        {





   "hconcat": [
    {
        "data": {
        "url": "https://raw.githubusercontent.com/TheSingularity-42/3179/main/VegaLite/Assignment2Data/SharkAttacks.csv"
        },
        "width" : 175,
        "height" : 400,
        "transform": [
            {"aggregate": [{"op": "count", "as": "provocationcount"}], "groupby": ["shark", "provocation"]},
            {"filter" : {
                "param": "selectFilter"
            }}
        ],
        "mark":"bar",
        "encoding": {
            "x": {"field":"provocation", "type": "nominal",
                "axis": {
                    "title" : null,
                    "labelExpr": "datum.value === 'provoked'? 'Provoked' : datum.value === 'unprovoked' ? 'Unprovoked' : 'Unknown'",
                    "labelAngle" :45
                }
            },
            "y" :{"field":"provocationcount","type":"quantitative",
            "axis" :{
                "title" : "Number Of Attacks"
            }
            },
            "color" :{
                "field": "provocation",
                "type": "nominal",
                "scale": {
                "domain": ["fatal", "injured", "uninjured","provoked", "unprovoked", "unknown"],
                "range": ["red", "blue", "green", "#fb00a4","orange","grey"]
                },
                "legend":{
                    "title": "Type of Attack",
                    "titleFontSize":24,
                    "labelFontSize":16,
                "values": ["fatal","injured","uninjured","provoked", "unprovoked","unknown"],
                "labelExpr": "datum.value === 'fatal' ? 'Fatal Injury' : datum.value === 'injured' ? 'Non-Fatal Injury' : datum.value === 'uninjured' ? 'Uninjured' : datum.value === 'provoked' ? 'Provoked Shark': datum.value === 'unprovoked' ? 'Unprovoked Attack': 'Unknown'"
                },
                "title": "Legend"
            },
            "tooltip" :[
                {"field" : "provocation", "title": "Provocation Level"},
                {"field": "shark", "title" : "Shark Species"},
                {
                    "field" : "provocationcount", "title" : "Number of Attacks" 
                }
            ]
        }   
    },
    {
        "data": {
        "url": "https://raw.githubusercontent.com/TheSingularity-42/3179/main/VegaLite/Assignment2Data/SharkAttacks.csv"
        },
        "width" : 175,
        "height" : 400,
        "transform": [
            {"aggregate": [{"op": "count", "as": "fatalitycount"}], "groupby": ["shark", "injury"]},
            {"filter" : {
                "param": "selectFilter"
            }}
        ],
        "mark":"bar",
        "encoding": {
            "x":{"field":"injury","type": "nominal",
        "axis" :{
            "title" : null,
            "labelAngle" : 45,
            "labelExpr": "datum.value === 'fatal' ? 'Fatal Injury' : datum.value === 'injured' ? 'Injured' : datum.value === 'uninjured' ? 'Uninjured' : datum.value === 'provoked' ? 'Provoked Shark': datum.value === 'unprovoked' ? 'Unprovoked Attack': 'Unknown'"
        }
        

        },
            "y":{"field":"fatalitycount", "type": "quantitative",
        "axis" : {
            "title" : null
        }
        },
            "color" :{
                "field": "injury",
                "type": "nominal",
                "scale": {
                "domain": ["fatal", "injured", "uninjured","provoked", "unprovoked", "unknown"],
                "range": ["red", "blue", "green", "#fb00a4","orange","grey"]
                },
                "legend":null
            },
            "tooltip" :[
                {"field": "injury", "title": "Injury Level"},
                {"field": "shark", "title" : "Shark Species"},
                {"field":"fatalitycount","title":"Number of Attacks"}
                
            ]
        }
        
    }


   ]
}
],
"resolve": {
    "legend": {
        "color": "independent"
    },
    "scale": {"color": "independent"}
}
}